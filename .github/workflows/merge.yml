 name: Merge Pull Request
 on:
   workflow_run:
     workflows: ["Django Tests"]
     types: [completed] #requested
   workflow_dispatch:

 jobs:
   merge_pull_request:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    steps:
  
    - name: Checkout code
      uses: actions/checkout@v2
      
    - name: Merge Pull Request
      uses: actions/github-script@0.9.0
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        PR_NUMBER: ${{ github.event.pull_request.number }}
        script: |
          env: PR_NUMBER
          const prNumber=PR_NUMBER
          await github.pulls.merge({
            owner: context.repo.owner,
            repo: context.repo.repo,
            pull_number: prNumber,
          });
          console.log(`Pull Request #${prNumber} merged.`);

